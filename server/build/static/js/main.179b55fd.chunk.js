(this["webpackJsonpreact-openlayers-map"]=this["webpackJsonpreact-openlayers-map"]||[]).push([[0],{149:function(e,t,a){},150:function(e,t,a){},152:function(e,t,a){},179:function(e,t,a){},181:function(e,t,a){},184:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(76),s=a.n(r),i=a(33),o=a(66),l=a(29),u=a(15),d=(a(149),a(150),new c.a.createContext),j=a(128),O=a(195),b=a(7),m=a(68),h="TOPOGRAFIC_MAP",p="ORTOFOTOMAPA_MAP",f="MUNICIPIS_LAYER",g="COMARQUES_LAYER",x=a(2),v=function(e){var t=e.selectedBaseLayer,a=e.selectLayers,c=e.opacityLayer,r=e.children,s=Object(n.useRef)(),o=Object(n.useState)(null),l=Object(i.a)(o,2),u=l[0],v=l[1],y=Object(n.useState)(null),C=Object(i.a)(y,2),A=C[0],L=C[1];return Object(n.useEffect)((function(){var e=Object(b.k)("EPSG:25831");e.setExtent([257904,4484796,535907,4751795]);var t={view:new j.a({zoom:1.5,center:[396905,4618292],projection:e,extent:[257904,4484796,535907,4751795]}),controls:[]},a=new O.a(t);return a.setTarget(s.current),L(t),v(a),function(){return a.setTarget(void 0)}}),[]),Object(n.useEffect)((function(){(u||A)&&u.getLayers().forEach((function(e){e instanceof m.a?e.getLayers().forEach((function(t,a,n){c.dom_element.parentElement.firstElementChild.value==t.get("title")&&e.setOpacity(parseFloat(c.value))})):c.dom_element.parentElement.firstElementChild.value==e.get("title")&&e.setOpacity(parseFloat(c.value))}))}),[c.value]),Object(n.useEffect)((function(){(u||A)&&u.getLayers().forEach((function(e){e instanceof m.a?e.getLayers().forEach((function(t,n,c){a.COMARQUES_LAYER&&t&&t.get("title")==g||a.MUNICIPIS_LAYER&&t&&t.get("title")==f?e.setVisible(!0):e&&(u.removeLayer(e),e.setVisible(!1))})):t.ORTOFOTOMAPA_MAP&&e&&e.get("title")==p||t.TOPOGRAFIC_MAP&&e&&e.get("title")==h?e.setVisible(!0):e&&(u.removeLayer(e),e.setVisible(!1))}))}),[t,a.COMARQUES_LAYER,a.MUNICIPIS_LAYER]),Object(x.jsx)(d.Provider,{value:{map:u},children:Object(x.jsx)("div",{ref:s,className:"ol-map",children:r})})},y=function(e){var t=e.children;return Object(x.jsx)("div",{children:t})},C=(a(152),a(127)),A=a(117),L=a(119),E=a(198),N=a(106),R=a(199),P=a(118),_=a(105),w=a(129),M=function(e){var t=e.usersData;_.a.defs("EPSG:25831","+proj=utm +zone=31 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),Object(P.a)(_.a);var a=Object(n.useContext)(d).map;return Object(n.useEffect)((function(){if(a){var e=document.getElementById("popup"),t=document.getElementById("popup-content"),n=document.getElementById("popup-closer"),c=new w.a({element:e,autoPan:!0,autoPanAnimation:{duration:250}});n.onclick=function(){return c.setPosition(void 0),n.blur(),!1},a.addOverlay(c),a.on("singleclick",(function(e){var n=e.coordinate,r=a.forEachFeatureAtPixel(e.pixel,(function(e){return e}));r&&(t.innerHTML="<p>Hola s\xf3c el/la "+r.get("name")+" </p>",c.setPosition(n))}))}}),[a]),Object(n.useEffect)((function(){if(a){var e=Object(b.k)("EPSG:25831"),n=new E.a({features:[]}),c=new C.a({source:n}),r=new N.b({image:new R.a({anchor:[16,48],anchorXUnits:"pixels",anchorYUnits:"pixels",imgSize:[48,48],src:"https://vfernandez.me/colegiatsAplicacio/icons/kid.png"})});return null===t||void 0===t||t.forEach((function(t,a){var c=new L.a({geometry:new A.a(Object(b.h)([Number(t.latitud),Number(t.longitud)],e)),name:t.nom});c.setStyle(r),n.addFeature(c)})),a.addLayer(c),c.setZIndex(400),function(){}}}),[a,t]),null},S=a(75),I=function(e){var t=e.source,a=e.title,c=Object(n.useContext)(d).map;return Object(n.useEffect)((function(){if(c){var e=new S.a({source:t,title:a});c.addLayer(e)}}),[c]),null},k=function(e){var t=e.source,a=e.title,c=e.selectedBaseLayer,r=Object(n.useContext)(d).map;return Object(n.useEffect)((function(){if(r){var e,n=t.map((function(e,t){return new S.a({source:e,title:a})}));e=new m.a({layers:n}),r.addLayer(e)}}),[r,c]),null};a(120);a(190);var B=a(57);var T=function(){return new B.a({url:"http://mapcache.icc.cat/map/bases/service?",params:{LAYERS:"topo"}})};var Y=function(){return new B.a({url:"http://geoserveis.icgc.cat/icc_mapesbase/wms/service?",params:{LAYERS:"orto25c"}})};var U=function(){return[new B.a({url:"http://geoserveis.icc.cat/icgc_bm5m/wms/service?",params:{LAYERS:"20_COMARCA_PC"}}),new B.a({url:"http://geoserveis.icc.cat/icgc_bm5m/wms/service?",params:{LAYERS:"50_NOMCAP_TX"}})]};var F=function(){return[new B.a({url:"http://geoserveis.icc.cat/icgc_bm5m/wms/service?",params:{LAYERS:"02_TIPUSLINIA_LN"}}),new B.a({url:"http://geoserveis.icc.cat/icgc_bm5m/wms/service?",params:{LAYERS:"50_NOMCAP_TX"}})]},G=function(e){var t=e.children;return Object(x.jsx)("div",{children:t})},V=a(107),Q=function(){var e=Object(n.useContext)(d).map;return Object(n.useEffect)((function(){if(e){var t=new V.a({});return e.controls.push(t),function(){return e.controls.remove(t)}}}),[e]),null},z=function(e){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("input",{type:e.type,name:e.name,defaultValue:e.defaultValue,checked:e.checked,onChange:e.onChange,className:e.className,defaultChecked:e.defaultChecked,id:e.id,disabled:e.disabled}),Object(x.jsx)("label",{children:e.layerName}),Object(x.jsx)("input",{defaultValue:"1",id:"topoOpacity",className:"opacity margin-left-10",type:"range",min:"0",max:"1",step:"0.01",onChange:e.onChangeRange,disabled:e.disabled})]})},q=function(e){return Object(x.jsx)("div",{className:"main-menu "+(e.openMenuOptions?"open":""),id:"mainMenuContainer",children:Object(x.jsxs)("div",{className:"main-menu-options",children:[Object(x.jsx)("div",{id:"menuLeftBaseLayers",className:"margin-top-10 cursor-pointer",children:"Capes"}),Object(x.jsx)("div",{className:"separation-line"}),Object(x.jsxs)("div",{id:"inputsLayers",children:[Object(x.jsx)("div",{className:"aligns-items",children:Object(x.jsx)(z,{type:"radio",name:"baseLayerRadioButton",defaultValue:h,checked:e.selectedBaseLayer.TOPOGRAFIC_MAP,onChange:function(t){return e.handlerRadioButtonsBaseLayer(t.target)},className:"cursor-pointer",layerName:"ICC Topo",onChangeRange:function(t){return e.handlerOpacityLayer(t.target)},disabled:!0})}),Object(x.jsx)("div",{className:"aligns-items margin-top-10",children:Object(x.jsx)(z,{type:"radio",name:"baseLayerRadioButton",defaultValue:p,checked:e.selectedBaseLayer.ORTOFOTOMAPA_MAP,onChange:function(t){return e.handlerRadioButtonsBaseLayer(t.target)},className:"cursor-pointer",layerName:"ICC Orto",onChangeRange:function(t){return e.handlerOpacityLayer(t.target)}})}),Object(x.jsx)("div",{className:"aligns-items margin-top-10",children:Object(x.jsx)(z,{type:"checkbox",name:"comarquesCheckBox",defaultValue:g,onChange:function(t){return e.handlerCheckButtonsLayers(t.target)},className:"cursor-pointer",layerName:"Comarques",defaultChecked:!0,id:"comarques",onChangeRange:function(t){return e.handlerOpacityLayer(t.target)},disabled:!0})}),Object(x.jsx)("div",{className:"aligns-items margin-top-10",children:Object(x.jsx)(z,{type:"checkbox",name:"municipisCheckBox",defaultValue:f,onChange:function(t){return e.handlerCheckButtonsLayers(t.target)},className:"cursor-pointer",layerName:"Municipis",defaultChecked:!1,id:"municipis",onChangeRange:function(t){return e.handlerOpacityLayer(t.target)},disabled:!0})})]})]})})},D=a(74),J=a.n(D),X=a(121);window.jQuery=window.$=X;a(183);var H=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1],r=Object(n.useState)({ORTOFOTOMAPA_MAP:!0,TOPOGRAFIC_MAP:!1}),s=Object(i.a)(r,2),l=s[0],d=s[1],j=Object(n.useState)({COMARQUES_LAYER:!1,MUNICIPIS_LAYER:!1}),O=Object(i.a)(j,2),b=O[0],m=O[1],C=Object(n.useState)({dom_element:null,value:null}),A=Object(i.a)(C,2),L=A[0],E=A[1],N=Object(n.useState)(null),R=Object(i.a)(N,2),P=R[0],_=R[1];Object(n.useEffect)((function(){J.a.get("/api").then((function(e){return _(e.data)})).catch((function(e){return console.log(e)}))}),[]);return Object(x.jsxs)("div",{className:"grid-container",children:[Object(x.jsx)(q,{selectedBaseLayer:l,openMenuOptions:a,handlerRadioButtonsBaseLayer:function(e){var t={TOPOGRAFIC_MAP:e.value==h?e.checked:!e.checked,ORTOFOTOMAPA_MAP:e.value==p?e.checked:!e.checked};d(t)},handlerCheckButtonsLayers:function(e){switch(e.value){case g:m((function(t){return Object(u.a)(Object(u.a)({},t),{},{COMARQUES_LAYER:e.checked})}));break;case f:m((function(t){return Object(u.a)(Object(u.a)({},t),{},{MUNICIPIS_LAYER:e.checked})}))}},handlerOpacityLayer:function(e){var t={dom_element:e,value:e.value};E(t)}}),Object(x.jsxs)("div",{id:"map",className:"map",children:[Object(x.jsxs)("div",{id:"popup",className:"ol-popup",children:[Object(x.jsx)("a",{href:"#",id:"popup-closer",className:"ol-popup-closer"}),Object(x.jsx)("div",{id:"popup-content"})]}),Object(x.jsxs)("div",{className:"title",children:[Object(x.jsx)("div",{id:"menuLeft",className:"bar-menu-left",onClick:function(){return c((function(e){return!e}))},children:Object(x.jsx)("i",{className:"fa fa-bars","aria-hidden":"true"})}),Object(x.jsx)("h4",{children:"Mapa dels colegiats/des"}),Object(x.jsx)(o.b,{to:"/login",children:Object(x.jsx)("div",{className:"cursor-pointer user-div",children:Object(x.jsx)("i",{className:"fa fa-user","aria-hidden":"true"})})})]}),Object(x.jsxs)(v,{selectedBaseLayer:l,selectLayers:b,opacityLayer:L,children:[Object(x.jsxs)(y,{children:[l.TOPOGRAFIC_MAP&&Object(x.jsx)(I,{source:T(),title:h}),l.ORTOFOTOMAPA_MAP&&Object(x.jsx)(I,{source:Y(),title:p}),b.COMARQUES_LAYER&&Object(x.jsx)(k,{source:U(),title:g,selectedBaseLayer:l}),b.MUNICIPIS_LAYER&&Object(x.jsx)(k,{source:F(),title:f,selectedBaseLayer:l}),Object(x.jsx)(M,{usersData:P})]}),Object(x.jsx)(G,{children:Object(x.jsx)(Q,{})})]})]})]})},K=(a(179),a(197)),Z=a(193),$=a(192),W=a(196),ee=a(191),te=function(e){var t=Object(l.f)(),a=Object(n.useState)(""),c=Object(i.a)(a,2),r=c[0],s=c[1],u=Object(n.useState)(""),d=Object(i.a)(u,2),j=d[0],O=d[1],b=e.loginResult,m=e.setLoginResult;return Object(x.jsxs)("div",{children:[Object(x.jsx)(o.b,{to:"/",children:Object(x.jsx)("div",{className:"cursor-pointer return-arrow",children:Object(x.jsx)("i",{className:"fas fa-arrow-left fa-2x","aria-hidden":"true"})})}),Object(x.jsx)(ee.a,{className:"main-container",children:Object(x.jsxs)($.a,{className:"justify-content-md-center",children:[Object(x.jsx)("h4",{children:"LOGUEJA'T"}),Object(x.jsxs)(K.a,{className:"register-form margin-top-20",children:[Object(x.jsxs)(K.a.Group,{controlId:"username",children:[Object(x.jsx)(K.a.Label,{children:"Usuari"}),Object(x.jsx)(K.a.Control,{type:"text",placeholder:"Entra l'usuari",name:"username",onChange:function(e){s(e.target.value)}})]}),Object(x.jsxs)(K.a.Group,{controlId:"password",className:"margin-top-20",children:[Object(x.jsx)(K.a.Label,{children:"Contrasenya"}),Object(x.jsx)(K.a.Control,{type:"password",placeholder:"Entra la contrasenya",name:"password",onChange:function(e){O(e.target.value)}})]}),Object(x.jsx)(Z.a,{onClick:function(){var e={username:r,password:j};J.a.post("http://localhost:3001/login",e).then((function(e){e.data.statusOK?(m((function(e){return{statusOk:!0,messageError:null}})),t.push("/dashBoard")):m((function(t){return{statusOk:!1,messageError:e.data.error}}))})).catch((function(e){return console.log(e)}))},className:"margin-top-20",children:" Accedir "})]}),null!=b.messageError&&Object(x.jsx)(W.a,{className:"margin-top-20",variant:"danger",children:b.messageError}),Object(x.jsxs)("div",{className:"margin-top-20",children:[Object(x.jsx)("div",{children:"Usuari: adminColegiGeografs"}),Object(x.jsx)("div",{children:"Password: @32250170a0dca92d53ec9624f336ca24"})]})]})})]})},ae=(a(181),a(194)),ne=function(e){var t=Object(n.useState)(null),a=Object(i.a)(t,2),c=a[0],r=a[1];Object(n.useEffect)((function(){J.a.get("/api").then((function(e){return r(e.data)})).catch((function(e){return console.log(e)}))}),[]);var s=[];return null===c||void 0===c||c.map((function(e,t){s.push(Object(x.jsxs)("tr",{children:[Object(x.jsx)("td",{children:e.idgeograf}),Object(x.jsx)("td",{children:e.nom}),Object(x.jsx)("td",{children:e.cognoms}),Object(x.jsx)("td",{children:Object(x.jsx)(Z.a,{variant:"danger",children:"Eliminar"})})]},t))})),Object(x.jsxs)("div",{className:"main-container-dashboard",children:[Object(x.jsx)("h2",{children:"Dashboard"}),Object(x.jsxs)("div",{className:"table-div",children:[Object(x.jsxs)(ae.a,{striped:!0,bordered:!0,hover:!0,children:[Object(x.jsx)("thead",{children:Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"idGeograf"}),Object(x.jsx)("th",{children:"Nom"}),Object(x.jsx)("th",{children:"Cognoms"})]})}),Object(x.jsx)("tbody",{children:s})]}),Object(x.jsx)(Z.a,{variant:"success",children:"Afegir"})]})]})};var ce=function(){var e=Object(n.useState)({statusOk:null,messageError:null}),t=Object(i.a)(e,2),a=t[0],c=t[1];return Object(x.jsx)("div",{className:"App",children:Object(x.jsx)(o.a,{children:Object(x.jsxs)(l.c,{children:[Object(x.jsx)(l.a,{path:"/",exact:!0,component:H}),Object(x.jsx)(l.a,{path:"/login",exact:!0,component:function(){return Object(x.jsx)(te,{loginResult:a,setLoginResult:c})}}),Object(x.jsx)(l.a,{path:"/dashboard",exact:!0,component:ne})]})})})};a(182);s.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(ce,{})}),document.getElementById("root"))}},[[184,1,2]]]);
//# sourceMappingURL=main.179b55fd.chunk.js.map